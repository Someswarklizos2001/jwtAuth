const crypto=require('crypto');
function encryption(password,length){
    
    const charset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
    let salt = '';
    for (let i = 0; i < length; i++) {
        const randomIndex = Math.floor(Math.random() * charset.length);
        salt += charset[randomIndex];
    }

    const hash=crypto.createHash('sha256');    
    hash.update(salt + password);
    return [hash.digest('hex'),salt];

}

function is_match(password,salt,hashedPassword){

    const hash=crypto.createHash('sha256');  
    hash.update(salt+password)
    const  encryptedPassword=hash.digest('hex')
    if(encryptedPassword===hashedPassword)return true
    else return false
}
module.exports={encryption,is_match};